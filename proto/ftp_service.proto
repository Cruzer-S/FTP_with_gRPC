syntax = "proto3";

import "hash.proto";
import "file.proto";

service FTPService {
  rpc UploadFile(stream UploadFileRequest) returns (UploadFileResponse);
}

message UploadFileRequest {
  oneof request {
    UploadInit init = 1;
    UploadChunk chunk = 2;
    UploadFinish finish = 3;
  } 
}

message UploadFileResponse {
  FileMetaData metadata = 1;
  Hash hash = 2;
}

message UploadInit {
  string filepath = 1;
  optional uint64 filesize = 2;
  optional HashType hashtype = 3;
};

message UploadChunk {
  bytes data = 1;
  optional uint64 offset = 2;
};

message UploadFinish {
  optional Hash hash = 1;
};
